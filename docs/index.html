<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>simple_cache - In-Memory LRU Cache for Eiffel</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" type="image/png" href="images/logo.png">
</head>
<body>
    <header>
        <div class="logo-container">
            <img src="images/logo.png" alt="simple_* logo" class="logo">
        </div>
        <h1>simple_cache</h1>
        <p class="tagline">In-Memory LRU Cache with TTL and Redis Support for Eiffel</p>
        <div class="badges">
            <span class="badge badge-rfc">Service Layer</span>
            <span class="badge badge-version">v1.0.0</span>
            <span class="badge badge-license">MIT</span>
        </div>
    </header>

    <nav>
        <ul>
            <li><a href="#overview">Overview</a></li>
            <li><a href="quick.html">QUICK API</a></li>
            <li><a href="#quick-start">Quick Start</a></li>
            <li><a href="#features">Features</a></li>
            <li><a href="#api">API Reference</a></li>
            <li><a href="https://github.com/simple-eiffel/simple_cache">GitHub</a></li>
        </ul>
    </nav>

    <main>
        <section id="overview">
            <h2>Overview</h2>
            <p>
                <strong>simple_cache</strong> provides a generic in-memory cache with Least Recently Used (LRU) 
                eviction policy for Eiffel applications. It supports optional Time-to-Live (TTL) for automatic 
                entry expiration and tracks cache statistics like hits, misses, and evictions.
            </p>
        </section>

        <section id="quick-start">
            <h2>Quick Start</h2>
            <h3>Installation</h3>
            <pre><code>&lt;library name="simple_cache" location="$SIMPLE_CACHE\simple_cache.ecf"/&gt;</code></pre>
            
            <h3>Basic Usage</h3>
            <pre><code>local
    cache: SIMPLE_CACHE [STRING]
do
    -- Create cache with max 100 entries
    create cache.make (100)

    -- Store values
    cache.put ("user:123", "Alice")
    cache.put ("user:456", "Bob")

    -- Retrieve values
    if attached cache.get ("user:123") as name then
        print ("Found: " + name)
    end

    -- Check statistics
    print ("Hit rate: " + (cache.hit_rate * 100).out + "%%")
end</code></pre>
        </section>

        <section id="features">
            <h2>Features</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>Generic Storage</h4>
                    <p>STRING keys with any value type via SIMPLE_CACHE [G]</p>
                </div>
                <div class="feature-card">
                    <h4>LRU Eviction</h4>
                    <p>Automatically removes least recently used entries when full</p>
                </div>
                <div class="feature-card">
                    <h4>TTL Support</h4>
                    <p>Optional time-to-live per entry or default expiration</p>
                </div>
                <div class="feature-card">
                    <h4>Statistics</h4>
                    <p>Track hits, misses, evictions, and hit rate</p>
                </div>
                <div class="feature-card">
                    <h4>Redis Support</h4>
                    <p>SIMPLE_REDIS_CACHE for distributed caching via Redis</p>
                </div>
                <div class="feature-card">
                    <h4>Redis Client</h4>
                    <p>SIMPLE_REDIS for low-level Redis commands</p>
                </div>
            </div>

            <h3>TTL (Time-to-Live)</h3>
            <pre><code>-- Cache with default 1-hour TTL
create cache.make_with_ttl (100, 3600)

-- Store with custom TTL (5 minutes)
cache.put_with_ttl ("temp:xyz", data, 300)

-- Entries automatically expire</code></pre>

            <h3>Redis Cache</h3>
            <pre><code>local
    cache: SIMPLE_REDIS_CACHE
do
    create cache.make ("localhost", 6379, 1000)
    if cache.connect then
        cache.put ("user:123", user_json)
        if attached cache.get ("user:123") as data then
            print (data)
        end
        cache.disconnect
    end
end</code></pre>

            <h3>Redis Client</h3>
            <pre><code>local
    redis: SIMPLE_REDIS
do
    create redis.make ("localhost", 6379)
    if redis.connect then
        redis.set ("key", "value")
        redis.setex ("temp", 60, "expires in 1 min")
        redis.incr ("counter")
        if redis.ping then
            print ("Connected!")
        end
        redis.disconnect
    end
end</code></pre>
        </section>

        <section id="api">
            <h2>API Reference</h2>
            
            <div class="api-section">
                <h3>make (a_max_size: INTEGER)</h3>
                <div class="signature">create cache.make (100)</div>
                <p>Create cache with maximum entries, no expiration.</p>
                <div class="contracts">
                    <h4>Require</h4>
                    <div class="require">positive_size: a_max_size > 0</div>
                    <h4>Ensure</h4>
                    <div class="ensure">max_size_set: max_size = a_max_size</div>
                    <div class="ensure">initially_empty: is_empty</div>
                </div>
            </div>

            <div class="api-section">
                <h3>make_with_ttl (a_max_size, a_ttl: INTEGER)</h3>
                <div class="signature">create cache.make_with_ttl (100, 3600)</div>
                <p>Create cache with maximum entries and default TTL in seconds.</p>
            </div>

            <div class="api-section">
                <h3>put (a_key: STRING; a_value: G)</h3>
                <div class="signature">cache.put ("user:123", "Alice")</div>
                <p>Store value with key. Uses default TTL if set.</p>
            </div>

            <div class="api-section">
                <h3>get (a_key: STRING): detachable G</h3>
                <div class="signature">if attached cache.get ("user:123") as v then ...</div>
                <p>Retrieve value. Returns Void if not found or expired.</p>
            </div>

            <h3>Statistics</h3>
            <table>
                <tr><th>Feature</th><th>Type</th><th>Description</th></tr>
                <tr><td><code>hits</code></td><td>INTEGER</td><td>Cache hit count</td></tr>
                <tr><td><code>misses</code></td><td>INTEGER</td><td>Cache miss count</td></tr>
                <tr><td><code>evictions</code></td><td>INTEGER</td><td>LRU eviction count</td></tr>
                <tr><td><code>hit_rate</code></td><td>REAL_64</td><td>Hit rate (0.0 to 1.0)</td></tr>
            </table>
        </section>
    </main>

    <footer>
        <p>Part of the <a href="https://github.com/simple-eiffel">simple_*</a> library collection</p>
        <p class="copyright">MIT License - Copyright (c) 2024-2025, Larry Rix</p>
    </footer>
</body>
</html>
