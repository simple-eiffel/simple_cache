<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>simple_cache - Eiffel LRU Cache Library</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        h1 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        h2 { color: #34495e; margin-top: 30px; }
        code { background: #f4f4f4; padding: 2px 6px; border-radius: 3px; font-family: 'Consolas', monospace; }
        pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 4px solid #3498db; }
        pre code { background: none; padding: 0; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #3498db; color: white; }
        tr:nth-child(even) { background: #f9f9f9; }
        .feature-box { background: #e8f4f8; padding: 15px; border-radius: 5px; margin: 10px 0; }
        a { color: #3498db; }
    </style>
</head>
<body>
    <h1>simple_cache</h1>
    <p><strong>In-memory LRU cache with optional TTL support for Eiffel applications</strong></p>

    <p><a href="https://github.com/ljr1981/simple_cache">GitHub Repository</a></p>

    <h2>Features</h2>
    <div class="feature-box">
        <ul>
            <li><strong>Generic key-value storage</strong> - STRING keys, any value type</li>
            <li><strong>LRU eviction</strong> - Automatically removes least recently used entries</li>
            <li><strong>Optional TTL</strong> - Time-to-live per entry or default</li>
            <li><strong>Statistics tracking</strong> - Hits, misses, evictions, hit rate</li>
        </ul>
    </div>

    <h2>Quick Start</h2>
    <pre><code>local
    cache: SIMPLE_CACHE [STRING]
do
    -- Create cache with max 100 entries
    create cache.make (100)

    -- Store values
    cache.put ("user:123", "Alice")
    cache.put ("user:456", "Bob")

    -- Retrieve values
    if attached cache.get ("user:123") as name then
        print ("Found: " + name)
    end
end</code></pre>

    <h2>TTL (Time-to-Live) Support</h2>
    <pre><code>-- Cache with default 1-hour TTL
create cache.make_with_ttl (100, 3600)

-- Store with default TTL
cache.put ("session:abc", session_data)

-- Store with custom TTL (5 minutes)
cache.put_with_ttl ("temp:xyz", data, 300)

-- Entries automatically expire
-- get() returns Void for expired entries</code></pre>

    <h2>LRU Eviction</h2>
    <pre><code>-- Small cache for demonstration
create cache.make (3)

cache.put ("a", 1)
cache.put ("b", 2)
cache.put ("c", 3)

-- Access "a" to make it most recently used
cache.get ("a")

-- Adding "d" evicts "b" (least recently used)
cache.put ("d", 4)

-- "a", "c", "d" remain; "b" was evicted</code></pre>

    <h2>Statistics</h2>
    <pre><code>-- Use the cache...
cache.put ("key1", "value1")
cache.get ("key1")  -- hit
cache.get ("key2")  -- miss

-- Check statistics
print ("Hits: " + cache.hits.out)
print ("Misses: " + cache.misses.out)
print ("Evictions: " + cache.evictions.out)
print ("Hit rate: " + (cache.hit_rate * 100).out + "%%")

-- Reset statistics
cache.reset_statistics</code></pre>

    <h2>API Reference</h2>

    <h3>Creation</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>make (max_size)</code></td><td>Create cache with max entries, no expiration</td></tr>
        <tr><td><code>make_with_ttl (max_size, ttl_seconds)</code></td><td>Create with default TTL</td></tr>
    </table>

    <h3>Storage</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>put (key, value)</code></td><td>Store value (uses default TTL if set)</td></tr>
        <tr><td><code>put_with_ttl (key, value, ttl)</code></td><td>Store with specific TTL in seconds</td></tr>
        <tr><td><code>remove (key)</code></td><td>Remove entry</td></tr>
        <tr><td><code>clear</code></td><td>Remove all entries</td></tr>
        <tr><td><code>prune_expired</code></td><td>Remove all expired entries</td></tr>
    </table>

    <h3>Access</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>get (key): detachable G</code></td><td>Get value (Void if not found/expired)</td></tr>
        <tr><td><code>has (key): BOOLEAN</code></td><td>Check if key exists and not expired</td></tr>
        <tr><td><code>count: INTEGER</code></td><td>Number of entries</td></tr>
        <tr><td><code>is_empty: BOOLEAN</code></td><td>Is cache empty?</td></tr>
        <tr><td><code>is_full: BOOLEAN</code></td><td>Is cache at capacity?</td></tr>
    </table>

    <h3>Statistics</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>hits: INTEGER</code></td><td>Cache hit count</td></tr>
        <tr><td><code>misses: INTEGER</code></td><td>Cache miss count</td></tr>
        <tr><td><code>evictions: INTEGER</code></td><td>LRU eviction count</td></tr>
        <tr><td><code>hit_rate: REAL_64</code></td><td>Hit rate (0.0 to 1.0)</td></tr>
        <tr><td><code>reset_statistics</code></td><td>Reset all counters</td></tr>
    </table>

    <h2>Installation</h2>
    <pre><code>&lt;library name="simple_cache" location="$SIMPLE_CACHE\simple_cache.ecf"/&gt;</code></pre>
    <p>Set environment variable: <code>SIMPLE_CACHE=D:\prod\simple_cache</code></p>

    <h2>Dependencies</h2>
    <ul>
        <li>EiffelBase only (no external dependencies)</li>
    </ul>

    <footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; color: #666;">
        <p>MIT License - Copyright (c) 2024-2025, Larry Rix</p>
    </footer>
</body>
</html>
